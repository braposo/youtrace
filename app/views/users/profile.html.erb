<% content_for :headers do %>
 	<script type="text/javascript"><!--
	clickHeatSite = 'youtrace';clickHeatGroup = 'public_profile';clickHeatServer = 'http://localhost/clickheat/click.php';initClickHeat(); //-->
	</script>
<% end %>
<div class="tabs">
	<span class="back"><%= link_to "&larr; Back", :back %></span>
	<span class="active">Profile: <strong><%= @user.login %></strong></span>
</div>
<div class="yui-g main">
  <div class="yui-u info first">   
  	<div class="box">
  		<div class="box-header">	
  			<%= image_tag 'mark.png', :class => 'mark' %>
  			<h1>Details</h1>
			<div class="box-options">
				<%= image_tag 'icons/move.png', :size => '16x16', :class => 'move', :tooltip => 'Move box'  %>
				<%= image_tag 'icons/collapse.png', :size => '16x16', :class => 'collapse', :tooltip => 'Collapse/Expand'  %>
			</div>
  		</div>
  		<div class="box-content">
			<ul class="details">
		  		<li><div>Name</div> <%= @user.name.empty? ? 'n/a' : @user.name -%></li>
		  		<li><div>Location</div> n/a</li>
		  		<li><div>Email</div> <%= @user.email -%></li>
		  		<li><div>Birthday</div> <%= @user.birthdate.nil? ? 'n/a' : @user.birthdate.to_s(:long) -%></li>
		  		<li><div>Gender</div> <%= @user.gender.nil? ? 'n/a' : @user.gender -%></li>
		  	</ul>
			<div class="photo"><%= photo_or_gravatar_for @user, {:size => 100} %></div>
			<div class="cf"></div>
  		</div>
  	</div>
	<div class="box">
  		<div class="box-header">	
			<%= image_tag 'mark.png', :class => 'mark' %>
			<h1>Latest Messages</h1>
			<div class="box-options">
				<%= image_tag 'icons/move.png', :size => '16x16', :class => 'move', :tooltip => 'Move box'  %>
				<%= image_tag 'icons/collapse.png', :size => '16x16', :class => 'collapse', :tooltip => 'Collapse/Expand'  %>
			</div>
		</div>
		<div class="box-content">
			<% if !@events.empty? -%>
		  		<% @events.each do |e| -%>
		  		   	<%= render :partial => 'events/message_item', :locals => { :e => e } %>
		  		<% end -%>
		  	<% else -%>
		  		No activity.
		  	<% end -%>
		</div>
	</div>	
  </div>
  <div class="yui-u">
	<div class="box">
		<div class="box-header">	
			<%= image_tag 'mark.png', :class => 'mark' %>
			<h1>Personal Map</h1>
			<div class="box-options">
				<%= image_tag 'icons/move.png', :size => '16x16', :class => 'move', :tooltip => 'Move box'  %>
				<%= image_tag 'icons/collapse.png', :size => '16x16', :class => 'collapse', :tooltip => 'Collapse/Expand'  %>
			</div>
		</div>
		<div class="box-content"><div id="map"></div></div>
	</div>
	<div class="box">
  		<div class="box-header">	
			<%= image_tag 'mark.png', :class => 'mark' %>
			<h1>Traces</h1>
			<div class="box-options">
				<%= image_tag 'icons/move.png', :size => '16x16', :class => 'move', :tooltip => 'Move box'  %>
				<%= image_tag 'icons/collapse.png', :size => '16x16', :class => 'collapse', :tooltip => 'Collapse/Expand'  %>
			</div>
		</div>
		<div class="box-content">
			<% if !@traces.empty? -%>
				<div class="item-list">
					<% @traces.each do |t| -%>
					   	<%= render :partial => 'traces/trace_item', :locals => { :t => t, :s => 'user'}%>
					<% end -%>
				</div>
			<% else -%>
				<h2>User has no public traces.</h2>
			<% end -%>
		</div>
	</div>	
  </div>
</div>
<div class="box-shadow">
	<div class="box-shadow-left"></div>
	<div class="box-shadow-right"></div>
</div>